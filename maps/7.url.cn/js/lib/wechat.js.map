{"version":3,"sources":["js/lib/wechat.js"],"names":["WeixinApi","weixinShareTimeline","data","callbacks","shareTimeline","theData","WeixinJSBridge","invoke","appid","appId","img_url","imgUrl","link","desc","title","img_width","img_height","resp","err_msg","cancel","confirm","fail","all","on","argv","async","ready","window","dataLoaded","Function","toString","indexOf","newData","weixinSendAppMessage","sendAppMessage","weixinShareWeibo","shareWeibo","content","url","weixinGeneralShare","generalShare","general","shareTo","addContact","appWeixinId","webtype","username","success","imagePreview","curSrc","srcList","length","current","urls","showOptionMenu","call","hideOptionMenu","showToolbar","hideToolbar","getNetworkType","callback","e","closeWindow","wxJsBridgeReady","readyCallback","Api","this","wxReadyFunc","document","addEventListener","attachEvent","version","shareToTimeline","shareToWeibo","shareToFriend"],"mappings":"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","file":"js/lib/wechat.js","sourcesContent":["/**!\r\n * 微信内置浏览器的Javascript API，功能包括：\r\n *\r\n * 1、分享到微信朋友圈\r\n * 2、分享给微信好友\r\n * 3、分享到腾讯微博\r\n * 4、新的分享接口，包含朋友圈、好友、微博的分享（for iOS）\r\n * 5、隐藏/显示右上角的菜单入口\r\n * 6、隐藏/显示底部浏览器工具栏\r\n * 7、获取当前的网络状态\r\n * 8、调起微信客户端的图片播放组件\r\n * 9、关闭公众平台Web页面\r\n *\r\n * @author zhaoxianlie(http://www.baidufe.com)\r\n */\r\nvar WeixinApi = (function () {\r\n\r\n    \"use strict\";\r\n\r\n    /**\r\n     * 分享到微信朋友圈\r\n     * @param       {Object}    data       待分享的信息\r\n     * @p-config    {String}    appId      公众平台的appId（服务号可用）\r\n     * @p-config    {String}    imgUrl     图片地址\r\n     * @p-config    {String}    link       链接地址\r\n     * @p-config    {String}    desc       描述\r\n     * @p-config    {String}    title      分享的标题\r\n     *\r\n     * @param       {Object}    callbacks  相关回调方法\r\n     * @p-config    {Boolean}   async                   ready方法是否需要异步执行，默认false\r\n     * @p-config    {Function}  ready(argv)             就绪状态\r\n     * @p-config    {Function}  dataLoaded(data)        数据加载完成后调用，async为true时有用，也可以为空\r\n     * @p-config    {Function}  cancel(resp)    取消\r\n     * @p-config    {Function}  fail(resp)      失败\r\n     * @p-config    {Function}  confirm(resp)   成功\r\n     * @p-config    {Function}  all(resp)       无论成功失败都会执行的回调\r\n     */\r\n    function weixinShareTimeline(data, callbacks) {\r\n        callbacks = callbacks || {};\r\n        var shareTimeline = function (theData) {\r\n            WeixinJSBridge.invoke('shareTimeline', {\r\n                \"appid\":theData.appId ? theData.appId : '',\r\n                \"img_url\":theData.imgUrl,\r\n                \"link\":theData.link,\r\n                \"desc\":theData.title,\r\n                \"title\":theData.desc, // 注意这里要分享出去的内容是desc\r\n                \"img_width\":\"640\",\r\n                \"img_height\":\"640\"\r\n            }, function (resp) {\r\n                switch (resp.err_msg) {\r\n                    // share_timeline:cancel 用户取消\r\n                    case 'share_timeline:cancel':\r\n                        callbacks.cancel && callbacks.cancel(resp);\r\n                        break;\r\n                    // share_timeline:confirm 发送成功\r\n                    case 'share_timeline:confirm':\r\n                    case 'share_timeline:ok':\r\n                        callbacks.confirm && callbacks.confirm(resp);\r\n                        break;\r\n                    // share_timeline:fail　发送失败\r\n                    case 'share_timeline:fail':\r\n                    default:\r\n                        callbacks.fail && callbacks.fail(resp);\r\n                        break;\r\n                }\r\n                // 无论成功失败都会执行的回调\r\n                callbacks.all && callbacks.all(resp);\r\n            });\r\n        };\r\n        WeixinJSBridge.on('menu:share:timeline', function (argv) {\r\n            if (callbacks.async && callbacks.ready) {\r\n                window[\"_wx_loadedCb_\"] = callbacks.dataLoaded || new Function();\r\n                if(window[\"_wx_loadedCb_\"].toString().indexOf(\"_wx_loadedCb_\") > 0) {\r\n                    window[\"_wx_loadedCb_\"] = new Function();\r\n                }\r\n                callbacks.dataLoaded = function (newData) {\r\n                    window[\"_wx_loadedCb_\"](newData);\r\n                    shareTimeline(newData);\r\n                };\r\n                // 然后就绪\r\n                callbacks.ready && callbacks.ready(argv);\r\n            } else {\r\n                // 就绪状态\r\n                callbacks.ready && callbacks.ready(argv);\r\n                shareTimeline(data);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 发送给微信上的好友\r\n     * @param       {Object}    data       待分享的信息\r\n     * @p-config    {String}    appId      公众平台的appId（服务号可用）\r\n     * @p-config    {String}    imgUrl     图片地址\r\n     * @p-config    {String}    link       链接地址\r\n     * @p-config    {String}    desc       描述\r\n     * @p-config    {String}    title      分享的标题\r\n     *\r\n     * @param       {Object}    callbacks  相关回调方法\r\n     * @p-config    {Boolean}   async                   ready方法是否需要异步执行，默认false\r\n     * @p-config    {Function}  ready(argv)             就绪状态\r\n     * @p-config    {Function}  dataLoaded(data)        数据加载完成后调用，async为true时有用，也可以为空\r\n     * @p-config    {Function}  cancel(resp)    取消\r\n     * @p-config    {Function}  fail(resp)      失败\r\n     * @p-config    {Function}  confirm(resp)   成功\r\n     * @p-config    {Function}  all(resp)       无论成功失败都会执行的回调\r\n     */\r\n    function weixinSendAppMessage(data, callbacks) {\r\n        callbacks = callbacks || {};\r\n        var sendAppMessage = function (theData) {\r\n            WeixinJSBridge.invoke('sendAppMessage', {\r\n                \"appid\":theData.appId ? theData.appId : '',\r\n                \"img_url\":theData.imgUrl,\r\n                \"link\":theData.link,\r\n                \"desc\":theData.desc,\r\n                \"title\":theData.title,\r\n                \"img_width\":\"640\",\r\n                \"img_height\":\"640\"\r\n            }, function (resp) {\r\n                switch (resp.err_msg) {\r\n                    // send_app_msg:cancel 用户取消\r\n                    case 'send_app_msg:cancel':\r\n                        callbacks.cancel && callbacks.cancel(resp);\r\n                        break;\r\n                    // send_app_msg:confirm 发送成功\r\n                    case 'send_app_msg:confirm':\r\n                    case 'send_app_msg:ok':\r\n                        callbacks.confirm && callbacks.confirm(resp);\r\n                        break;\r\n                    // send_app_msg:fail　发送失败\r\n                    case 'send_app_msg:fail':\r\n                    default:\r\n                        callbacks.fail && callbacks.fail(resp);\r\n                        break;\r\n                }\r\n                // 无论成功失败都会执行的回调\r\n                callbacks.all && callbacks.all(resp);\r\n            });\r\n        };\r\n        WeixinJSBridge.on('menu:share:appmessage', function (argv) {\r\n            if (callbacks.async && callbacks.ready) {\r\n                window[\"_wx_loadedCb_\"] = callbacks.dataLoaded || new Function();\r\n                if(window[\"_wx_loadedCb_\"].toString().indexOf(\"_wx_loadedCb_\") > 0) {\r\n                    window[\"_wx_loadedCb_\"] = new Function();\r\n                }\r\n                callbacks.dataLoaded = function (newData) {\r\n                    window[\"_wx_loadedCb_\"](newData);\r\n                    sendAppMessage(newData);\r\n                };\r\n                // 然后就绪\r\n                callbacks.ready && callbacks.ready(argv);\r\n            } else {\r\n                // 就绪状态\r\n                callbacks.ready && callbacks.ready(argv);\r\n                sendAppMessage(data);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 分享到腾讯微博\r\n     * @param       {Object}    data       待分享的信息\r\n     * @p-config    {String}    link       链接地址\r\n     * @p-config    {String}    desc       描述\r\n     *\r\n     * @param       {Object}    callbacks  相关回调方法\r\n     * @p-config    {Boolean}   async                   ready方法是否需要异步执行，默认false\r\n     * @p-config    {Function}  ready(argv)             就绪状态\r\n     * @p-config    {Function}  dataLoaded(data)        数据加载完成后调用，async为true时有用，也可以为空\r\n     * @p-config    {Function}  cancel(resp)    取消\r\n     * @p-config    {Function}  fail(resp)      失败\r\n     * @p-config    {Function}  confirm(resp)   成功\r\n     * @p-config    {Function}  all(resp)       无论成功失败都会执行的回调\r\n     */\r\n    function weixinShareWeibo(data, callbacks) {\r\n        callbacks = callbacks || {};\r\n        var shareWeibo = function (theData) {\r\n            WeixinJSBridge.invoke('shareWeibo', {\r\n                \"content\":theData.desc,\r\n                \"url\":theData.link\r\n            }, function (resp) {\r\n                switch (resp.err_msg) {\r\n                    // share_weibo:cancel 用户取消\r\n                    case 'share_weibo:cancel':\r\n                        callbacks.cancel && callbacks.cancel(resp);\r\n                        break;\r\n                    // share_weibo:confirm 发送成功\r\n                    case 'share_weibo:confirm':\r\n                    case 'share_weibo:ok':\r\n                        callbacks.confirm && callbacks.confirm(resp);\r\n                        break;\r\n                    // share_weibo:fail　发送失败\r\n                    case 'share_weibo:fail':\r\n                    default:\r\n                        callbacks.fail && callbacks.fail(resp);\r\n                        break;\r\n                }\r\n                // 无论成功失败都会执行的回调\r\n                callbacks.all && callbacks.all(resp);\r\n            });\r\n        };\r\n        WeixinJSBridge.on('menu:share:weibo', function (argv) {\r\n            if (callbacks.async && callbacks.ready) {\r\n                window[\"_wx_loadedCb_\"] = callbacks.dataLoaded || new Function();\r\n                if(window[\"_wx_loadedCb_\"].toString().indexOf(\"_wx_loadedCb_\") > 0) {\r\n                    window[\"_wx_loadedCb_\"] = new Function();\r\n                }\r\n                callbacks.dataLoaded = function (newData) {\r\n                    window[\"_wx_loadedCb_\"](newData);\r\n                    shareWeibo(newData);\r\n                };\r\n                // 然后就绪\r\n                callbacks.ready && callbacks.ready(argv);\r\n            } else {\r\n                // 就绪状态\r\n                callbacks.ready && callbacks.ready(argv);\r\n                shareWeibo(data);\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * 新的分享接口\r\n     * @param       {Object}    data       待分享的信息\r\n     * @p-config    {String}    appId      公众平台的appId（服务号可用）\r\n     * @p-config    {String}    imgUrl     图片地址\r\n     * @p-config    {String}    link       链接地址\r\n     * @p-config    {String}    desc       描述\r\n     * @p-config    {String}    title      分享的标题\r\n     *\r\n     * @param       {Object}    callbacks  相关回调方法\r\n     * @p-config    {Boolean}   async                   ready方法是否需要异步执行，默认false\r\n     * @p-config    {Function}  ready(argv,shareTo)             就绪状态\r\n     * @p-config    {Function}  dataLoaded(data)        数据加载完成后调用，async为true时有用，也可以为空\r\n     * @p-config    {Function}  cancel(resp,shareTo)    取消\r\n     * @p-config    {Function}  fail(resp,shareTo)      失败\r\n     * @p-config    {Function}  confirm(resp,shareTo)   成功\r\n     * @p-config    {Function}  all(resp,shareTo)       无论成功失败都会执行的回调\r\n     */\r\n    function weixinGeneralShare(data, callbacks) {\r\n        callbacks = callbacks || {};\r\n        var generalShare = function (general,theData) {\r\n\r\n            // 如果是分享到朋友圈，则需要把title和desc交换一下\r\n            if(general.shareTo == 'timeline') {\r\n                var title = theData.title;\r\n                theData.title = theData.desc || title;\r\n                theData.desc = title;\r\n            }\r\n\r\n            // 分享出去\r\n            general.generalShare({\r\n                \"appid\":theData.appId ? theData.appId : '',\r\n                \"img_url\":theData.imgUrl,\r\n                \"link\":theData.link,\r\n                \"desc\":theData.desc,\r\n                \"title\":theData.title,\r\n                \"img_width\":\"640\",\r\n                \"img_height\":\"640\"\r\n            }, function (resp) {\r\n                switch (resp.err_msg) {\r\n                    // general_share:cancel 用户取消\r\n                    case 'general_share:cancel':\r\n                        callbacks.cancel && callbacks.cancel(resp ,general.shareTo);\r\n                        break;\r\n                    // general_share:confirm 发送成功\r\n                    case 'general_share:confirm':\r\n                    case 'general_share:ok':\r\n                        callbacks.confirm && callbacks.confirm(resp ,general.shareTo);\r\n                        break;\r\n                    // general_share:fail　发送失败\r\n                    case 'general_share:fail':\r\n                    default:\r\n                        callbacks.fail && callbacks.fail(resp ,general.shareTo);\r\n                        break;\r\n                }\r\n                // 无论成功失败都会执行的回调\r\n                callbacks.all && callbacks.all(resp ,general.shareTo);\r\n            });\r\n        };\r\n        WeixinJSBridge.on('menu:general:share', function (general) {\r\n            if (callbacks.async && callbacks.ready) {\r\n                window[\"_wx_loadedCb_\"] = callbacks.dataLoaded || new Function();\r\n                if(window[\"_wx_loadedCb_\"].toString().indexOf(\"_wx_loadedCb_\") > 0) {\r\n                    window[\"_wx_loadedCb_\"] = new Function();\r\n                }\r\n                callbacks.dataLoaded = function (newData) {\r\n                    window[\"_wx_loadedCb_\"](newData);\r\n                    generalShare(general,newData);\r\n                };\r\n                // 然后就绪\r\n                callbacks.ready && callbacks.ready(general,general.shareTo);\r\n            } else {\r\n                // 就绪状态\r\n                callbacks.ready && callbacks.ready(general,general.shareTo);\r\n                generalShare(general,data);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 加关注（此功能只是暂时先加上，不过因为权限限制问题，不能用，如果你的站点是部署在*.qq.com下，也许可行）\r\n     * @param       {String}    appWeixinId     微信公众号ID\r\n     * @param       {Object}    callbacks       回调方法\r\n     * @p-config    {Function}  fail(resp)      失败\r\n     * @p-config    {Function}  confirm(resp)   成功\r\n     */\r\n    function addContact(appWeixinId,callbacks){\r\n        callbacks = callbacks || {};\r\n        WeixinJSBridge.invoke(\"addContact\", {\r\n            webtype: \"1\",\r\n            username: appWeixinId\r\n        }, function (resp) {\r\n            var success = !resp.err_msg || \"add_contact:ok\" == resp.err_msg || \"add_contact:added\" == resp.err_msg;\r\n            if(success) {\r\n                callbacks.success && callbacks.success(resp);\r\n            }else{\r\n                callbacks.fail && callbacks.fail(resp);\r\n            }\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 调起微信Native的图片播放组件。\r\n     * 这里必须对参数进行强检测，如果参数不合法，直接会导致微信客户端crash\r\n     *\r\n     * @param {String} curSrc 当前播放的图片地址\r\n     * @param {Array} srcList 图片地址列表\r\n     */\r\n    function imagePreview(curSrc,srcList) {\r\n        if(!curSrc || !srcList || srcList.length == 0) {\r\n            return;\r\n        }\r\n        WeixinJSBridge.invoke('imagePreview', {\r\n            'current' : curSrc,\r\n            'urls' : srcList\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 显示网页右上角的按钮\r\n     */\r\n    function showOptionMenu() {\r\n        WeixinJSBridge.call('showOptionMenu');\r\n    }\r\n\r\n\r\n    /**\r\n     * 隐藏网页右上角的按钮\r\n     */\r\n    function hideOptionMenu() {\r\n        WeixinJSBridge.call('hideOptionMenu');\r\n    }\r\n\r\n    /**\r\n     * 显示底部工具栏\r\n     */\r\n    function showToolbar() {\r\n        WeixinJSBridge.call('showToolbar');\r\n    }\r\n\r\n    /**\r\n     * 隐藏底部工具栏\r\n     */\r\n    function hideToolbar() {\r\n        WeixinJSBridge.call('hideToolbar');\r\n    }\r\n\r\n    /**\r\n     * 返回如下几种类型：\r\n     *\r\n     * network_type:wifi     wifi网络\r\n     * network_type:edge     非wifi,包含3G/2G\r\n     * network_type:fail     网络断开连接\r\n     * network_type:wwan     2g或者3g\r\n     *\r\n     * 使用方法：\r\n     * WeixinApi.getNetworkType(function(networkType){\r\n     *\r\n     * });\r\n     *\r\n     * @param callback\r\n     */\r\n    function getNetworkType(callback) {\r\n        if (callback && typeof callback == 'function') {\r\n            WeixinJSBridge.invoke('getNetworkType', {}, function (e) {\r\n                // 在这里拿到e.err_msg，这里面就包含了所有的网络类型\r\n                callback(e.err_msg);\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 关闭当前微信公众平台页面\r\n     */\r\n    function closeWindow() {\r\n        WeixinJSBridge.call(\"closeWindow\");\r\n    }\r\n\r\n    /**\r\n     * 当页面加载完毕后执行，使用方法：\r\n     * WeixinApi.ready(function(Api){\r\n     *     // 从这里只用Api即是WeixinApi\r\n     * });\r\n     * @param readyCallback\r\n     */\r\n    function wxJsBridgeReady(readyCallback) {\r\n        if (readyCallback && typeof readyCallback == 'function') {\r\n            var Api = this;\r\n            var wxReadyFunc = function () {\r\n                readyCallback(Api);\r\n            };\r\n            if (typeof window.WeixinJSBridge == \"undefined\"){\r\n                if (document.addEventListener) {\r\n                    document.addEventListener('WeixinJSBridgeReady', wxReadyFunc, false);\r\n                } else if (document.attachEvent) {\r\n                    document.attachEvent('WeixinJSBridgeReady', wxReadyFunc);\r\n                    document.attachEvent('onWeixinJSBridgeReady', wxReadyFunc);\r\n                }\r\n            }else{\r\n                wxReadyFunc();\r\n            }\r\n        }\r\n    }\r\n\r\n    return {\r\n        version         :\"2.0\",\r\n        ready           :wxJsBridgeReady,\r\n        shareToTimeline :weixinShareTimeline,\r\n        shareToWeibo    :weixinShareWeibo,\r\n        shareToFriend   :weixinSendAppMessage,\r\n        generalShare    :weixinGeneralShare,\r\n        addContact      :addContact,\r\n        showOptionMenu  :showOptionMenu,\r\n        hideOptionMenu  :hideOptionMenu,\r\n        showToolbar     :showToolbar,\r\n        hideToolbar     :hideToolbar,\r\n        getNetworkType  :getNetworkType,\r\n        imagePreview    :imagePreview,\r\n        closeWindow     :closeWindow\r\n    };\r\n})();"],"sourceRoot":"/source/"}